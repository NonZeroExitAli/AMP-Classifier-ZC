<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AMP Classifier</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 50px;
        }
        input, button {
            padding: 10px;
            font-size: 16px;
        }
        .result-card {
            margin-top: 20px;
            padding: 15px;
            display: none;
            font-size: 18px;
            font-weight: bold;
            border-radius: 5px;
        }
        .success { background-color: #4CAF50; color: white; }
        .warning { background-color: #FFC107; color: black; }
    </style>
    <script type="module">
        import { Client } from "https://cdn.jsdelivr.net/npm/@gradio/client/+esm";

        async function predict() {
            const sequenceInput = document.getElementById("sequenceInput");
            const predictBtn = document.getElementById("predictBtn");
            const resultDiv = document.getElementById("resultDiv");
            const predictionText = document.getElementById("predictionText");
            const timeDiv = document.getElementById("timeDiv");

            const sequence = sequenceInput.value.trim().toUpperCase();

            // Clear previous results
            resultDiv.style.display = 'none';
            predictionText.textContent = '';
            timeDiv.textContent = '';

            // Input validation
            if (sequence.length < 10 || sequence.length > 100) {
                resultDiv.style.display = 'block';
                resultDiv.className = 'result-card warning';
                predictionText.textContent = 'Sequence length must be between 10 and 100 characters.';
                return;
            }

            // Show loading state
            predictBtn.disabled = true;
            predictBtn.textContent = 'Processing...';

            try {
                const start = performance.now();
                
                // Create Gradio client and send request
                const client = await Client.connect("nonzeroexit/AMP-Classifier");
                const result = await client.predict("/predict", { sequence });

                const end = performance.now();

                // Update UI based on result
                resultDiv.style.display = 'block';
                resultDiv.className = `result-card ${result.data[0] === 'AMP' ? 'success' : 'warning'}`;
                predictionText.textContent = `Prediction: ${result.data[0]}`;
                timeDiv.textContent = `Processing time: ${(end - start).toFixed(2)}ms`;

            } catch (error) {
                console.error("Prediction error:", error);
                resultDiv.style.display = 'block';
                resultDiv.className = 'result-card warning';
                predictionText.textContent = 'Error: Prediction failed';
            } finally {
                predictBtn.disabled = false;
                predictBtn.textContent = 'Classify Sequence';
            }
        }
    </script>
</head>
<body>
    <h1>AMP Classifier</h1>
    <p>Enter a peptide sequence (10-100 characters):</p>
    <input type="text" id="sequenceInput" placeholder="Enter sequence" />
    <button id="predictBtn" onclick="predict()">Classify Sequence</button>

    <div id="resultDiv" class="result-card">
        <p id="predictionText"></p>
        <p id="timeDiv"></p>
    </div>
</body>
</html>
